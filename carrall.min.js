/*! carrall 21-04-2014 */
module.exports=window.carrall={setup:function(a){var b;return b=function(b){return carrall._fsroot=b.root,a()},window.requestFileSystem?window.requestFileSystem(LocalFileSystem.PERSISTENT,0,b,a):a()},isIOS:function(){return window.device&&window.device.platform?"iOS"===device.platform:/iphone|ipad|ipod/i.test(navigator.userAgent)},hasInternetConnection:function(){return navigator.onLine||navigator.connection.type!==Connection.NONE},getSystemLanguage:function(){var a;return navigator&&navigator.userAgent&&(a=navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))&&(a=a[1]),!a&&navigator&&(navigator.language?a=navigator.language:navigator.browserLanguage?a=navigator.browserLanguage:navigator.systemLanguage?a=navigator.systemLanguage:navigator.userLanguage&&(a=navigator.userLanguage),a=a.substr(0,2)),a},localize:function(a){return Localisation.Strings[carrall.getSystemLanguage()][a]||"Lazy developer did not provide string for "+a+" in language "+carrall.language},orientation:function(){return-90===window.orientation||90===window.orientation?"landscape":"portrait"},getPhonegapPath:function(){var a,b;return a=window.location.pathname,b=a.substring(0,a.lastIndexOf("/")+1)},ensureFreeSpace:function(a,b){return window.requestFileSystem(LocalFileSystem.PERSISTENT,a,b,function(){return navigator.notification.alert(carrall.localize("noFreeSpace"),b,carrall.localize("noFreeSpaceTitle"),carrall.localize("buttonOK"))})},disableDoubleTap:function(a){var b;return $(a).bind("touchstart",b=function(a){var b,c,d,e;return e=a.timeStamp,d=$(this).data("lastTouch")||e,b=e-d,c=a.originalEvent.touches.length,$(this).data("lastTouch",e),!b||b>500||c>1?void 0:(a.preventDefault(),$(this).trigger("click").trigger("click"))})},stopVScroll:function(a,b,c){var d;return document.addEventListener("touchmove",function(a){var b;return b=$(a.target),b.hasClass("scrollable")||1===b.parents(".scrollable-container").length?void 0:a.preventDefault()},!1),d=void 0,$(a).bind("touchstart",function(a){return d=a}),$(a).bind("touchmove",function(a){var e;return e=parseInt(a.originalEvent.pageY-d.originalEvent.pageY),e>b||c&&Math.abs(e)>5?(a.preventDefault(),!1):void 0})},saveJSONFile:function(a,b){var c,d,e;return c=function(a){return console.log(a)},e=function(a){return a.write(JSON.stringify(b))},d=function(a){return a.createWriter(e,c)},carrall._fsroot.getFile(a,{create:!0,exclusive:!1},d,c)},loadJSONFile:function(a,b,c,d){var e,f,g;return e=d,f=function(a){var e;return e=new FileReader,e.onloadend=function(a){var e;return e=JSON.parse(a.target.result),e&&(b[c]=e),d()},e.onerror=function(a){return console.log(a)},e.readAsText(a),0===a.size?d():void 0},g=function(a){return a.file(f,e)},carrall._fsroot.getFile(a,{create:!0,exclusive:!1},g,e)},saveXML:function(a,b,c){var d,e,f,g;return e=(new XMLSerializer).serializeToString(b[0]),d=function(a){return console.log(a)},g=function(a){return a.onwriteend=c,a.write(e)},f=function(a){return a.createWriter(g,d)},a=a.replace(carrall._fsroot.fullPath+"/",""),console.log("Trying to save "+a),carrall._fsroot.getFile(a,{create:!0,exclusive:!1},f,d)},loadXML:function(a,b,c){var d;return a.match(/^file:\//)||(a="file://"+a),c||(c=function(a){return console.log(a)}),d=a+"?"+(new Date).getTime(),$.ajax({url:d,method:"GET",dataType:"xml",error:c}).done(function(a){return b($(a))})}};